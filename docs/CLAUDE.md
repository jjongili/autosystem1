# 구매대행 통합관리 및 자동화 시스템

---

## 메모리뱅크 (컨텍스트 관리)

### 세션 시작 시 필수
새 세션 시작할 때 **반드시** 아래 파일들을 읽어서 컨텍스트를 로드하세요:

```
.claude/memory/activeContext.md   # 현재 진행 중인 작업
.claude/memory/progress.md        # 이전 진행 이력
.claude/memory/decisions.md       # 주요 결정사항
.claude/memory/techContext.md     # 기술 컨텍스트
```

### 작업 중 업데이트
중요한 변경/결정 시 메모리뱅크 파일 업데이트:
- 새 작업 시작: `activeContext.md` 업데이트
- 작업 완료: `progress.md`에 추가
- 기술 결정: `decisions.md`에 추가

### 세션 종료 시
- Hook이 자동으로 세션 요약 저장 (Stop hook)
- 수동 저장: `python .claude/hooks/memory_hook.py save "요약내용"`

---

## 프로젝트 목적

수백 개의 구매대행 마켓 계정을 **한눈에 관리**하면서, 매출이 없는 계정의 상품은 **자동 삭제**하고 **자동 재등록**하는 완전 자동화 시스템 구현

---

## 핵심 자동화 프로세스

### 1. 상품 생명주기 관리

```
[등록] → [1개월 모니터링] → [2개월 모니터링] → [삭제/유지 판단]
```

| 조건 | 경과일 | 월 매출 | 조치 |
|------|--------|---------|------|
| 신규등록 후 | 2개월+ | - | 노출/유입/전환 없으면 **삭제** |
| 재등록 후 | 1개월+ | 100만원 이하 | **삭제** |
| 재등록 후 | 2개월+ | 100만원 이상 | **삭제** (수명 만료) |
| 유지 대상 | 2개월 미만 | 100만원 이상 | **유지** |

### 2. 상품 재등록 프로세스

```
[삭제 대상 선정]
    ↓
[AI 상품명 변경 프로그램] → 새 상품명 생성
    ↓
[상품 복사] → 판매자코드 변경 (중복 방지)
    ↓
[불사자 프로그램으로 등록]
    ↓
[등록 후 상품명 재생성] → 기존 상품명과 중복 방지
```

### 3. 마케팅 분석 기반 상품 최적화

| 상태 | 노출 | 유입 | 전환 | 자동 조치 |
|------|------|------|------|-----------|
| 노출만 있음 | O | X | X | **AI 썸네일/상품명 자동 수정** |
| 유입만 있음 | O | O | X | 가격조정, 옵션점검, 상세페이지, 리뷰작업 (자동+수동) |
| 전환 있음 | O | O | O | 추가 점검 (최적화 여지 확인) |

→ **별도 탭에서 운영자 알림**

---

## 현재 시스템 구성

### 관제센터 (모니터링)
- **필터**: 상태, 용도, 소유자, 매출계급, 주문계급, 경과일
- **기능**: 다중 마켓 선택 → 올인원 작업 (삭제, API작업)

### 불사자 연동
- 반자동(반대량) 상품 등록/삭제 프로그램
- 현재: API 직접 삭제 → **불사자 연동 삭제로 전환 필요**

### 보조 프로그램 (개발중)
- 불사자 대량 업로드 보조 도구

---

## 개발 로드맵

### Phase 1: 마케팅 분석 완성 (우선)
- [x] 마케팅분석 탭 UI
- [x] 스마트스토어 로그인 (이메일/판매자ID 탭 전환 수정)
- [ ] **비즈어드바이저 데이터 수집 안정화**
- [ ] **쇼핑파트너센터 데이터 수집**
- [ ] 노출/유입/전환 데이터 시트 저장
- [ ] 분석 결과 대시보드

### Phase 2: 삭제 대상 자동 선정
- [ ] 경과일 + 매출 기준 자동 필터링
- [ ] 삭제 대상 목록 생성
- [ ] 삭제 대상 알림 (운영자 확인용)

### Phase 3: 불사자 연동 강화
- [ ] 불사자 프로그램 삭제 기능 연동
- [ ] 삭제 → 재등록 워크플로우 자동화
- [ ] 대량 업로드 보조 도구 완성

### Phase 4: AI 상품명 자동화
- [ ] 삭제 전 상품명 백업
- [ ] AI 신규 상품명 생성 (중복 체크)
- [ ] 판매자코드 자동 변경
- [ ] 등록 후 상품명 재확인

### Phase 5: 작업 대시보드
- [ ] 작업 달력 (일별 작업 현황)
- [ ] 실시간 작업 상태 모니터링
- [ ] 자동화 로그 / 히스토리

### Phase 6: 완전 자동화
- [ ] 스케줄러 기반 자동 실행
- [ ] 예외 처리 및 알림
- [ ] 수동 개입 최소화

---

## 기술 스택

| 구분 | 기술 |
|------|------|
| Backend | FastAPI, Python |
| Frontend | Vanilla JS (SPA) |
| 데이터 | Google Sheets (gspread) |
| 브라우저 자동화 | Playwright (SMS), Selenium (마케팅) |
| 스케줄러 | APScheduler |
| 실시간 통신 | WebSocket |

---

## 폴더 구조

```
autosystem1/
├── web_system/                 # 통합관리 웹서버
│   ├── server.py               # FastAPI 메인 서버
│   ├── modules/
│   │   ├── marketing_collector.py  # 마케팅 데이터 수집
│   │   ├── daily_sync.py           # 일일장부 동기화
│   │   ├── ali_tracking.py         # 알리 송장 수집
│   │   └── delivery_check.py       # 배송 상태 조회
│   ├── templates/
│   └── static/
├── 5. bulsaja_title_maker_*.py # AI 상품명 생성기
├── 7. bulsaja_uploader_*.py    # 불사자 업로더 보조
└── smartstore_allinone.py      # 스마트스토어 올인원
```

---

## 즉시 해결 필요 사항

### 마케팅 분석 로그인 문제
**문제**: 로그인 페이지에서 자동 로그인 실패
**원인**: "이메일 또는 판매자 아이디" 탭 미클릭
**해결**: `marketing_collector.py` 수정 완료 (탭 클릭 로직 추가)

### 다음 확인 필요
1. 탭 클릭 후 ID/PW 입력창 정상 표시 여부
2. 로그인 버튼 클릭 동작
3. SMS 2차 인증 처리
4. 비즈어드바이저/쇼핑파트너 데이터 수집
